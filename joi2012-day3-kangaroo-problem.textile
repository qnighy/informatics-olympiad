---
layout: default
title: "Kangaroo(カンガルー) - joi2012-day3"
source: "第11回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2012/2012-sp-tasks/index.html"
timelimit: "2秒"
memlimit: "64MB"
---

K 理事長はカンガルーに興味を持ち，カンガルーの行動を観察することにした．K 理事長は <var>N</var> 匹のカンガルーを観察している．カンガルーにはポケットが一つずつ付いている．カンガルーには <var>1, 2, …, N</var> の番号が付けられている．カンガルー <var>i</var> の本体のサイズは <var>A_i</var> であり，カンガルー <var>i</var> のポケットのサイズは <var>B_i</var> である．ポケットのサイズはそのカンガルーの本体のサイズより小さい (<var>A_i &gt; B_i</var>)．

最初にどのカンガルーのポケットの中にも他のカンガルーは入っていない．カンガルーは以下の操作を *操作ができなくなるまで* 繰り返す．

<var>A_i &lt; B_j</var> を満たすカンガルー <var>i</var> とカンガルー <var>j</var> の組であって，カンガルー <var>i</var> が他のカンガルーのポケットの中ではなく，カンガルー <var>j</var> のポケットの中に他のカンガルーがいないようなものが存在するとき，カンガルー <var>i</var> はカンガルー <var>j</var> のポケットの中に入る．このとき，カンガルー <var>i</var> のポケットの中に他のカンガルーがいても，カンガルー <var>j</var> が他のカンガルーのポケットの中にいても構わない．そのような <var>(i, j)</var> の組が複数存在するとき，どの組が選ばれるか分からない．カンガルー <var>i</var> の中に他のカンガルーが入っている場合，中のカンガルーはカンガルー <var>i</var> と一緒に移動する．

与えられたカンガルーの本体とポケットのサイズに対して，最後の状態が何通りあるかを <var>1\,000\,000\,007\,(= 10^9 + 7)</var> で割った余りを求めたい．

h2. 課題

カンガルーの本体とポケットのサイズが与えられたとき，最後の状態が何通りあるかを <var>1\,000\,000\,007\,(= 10^9 + 7)</var> で割った余りを求めるプログラムを作成せよ．


h2. 制限

| <var>1 \leqq N \leqq 300</var> | カンガルーの匹数 |
| <var>1 \leqq B_i &lt; A_i \leqq 1\,000\,000\,000</var> | <var>i</var> 匹目のカンガルーのポケットと本体のサイズ |

h2. 入力

標準入力から以下の入力を読み込め．
* 1 行目には整数 <var>N</var> が書かれている．<var>N</var> はカンガルーの匹数を表す．
* 続く <var>N</var> 行にはカンガルーの情報が書かれている．<var>i+1</var> 行目 <var>(1 \leqq i \leqq N)</var> には 2 つの整数 <var>A_i, B_i</var> が空白を区切りとして書かれている．<var>A_i</var> は <var>i</var> 匹目のカンガルーの本体のサイズを，<var>B_i</var> は <var>i</var> 匹目のカンガルーのポケットのサイズをそれぞれ表す．

h2. 出力

標準出力に，最後の状態が何通りあるかを <var>1\,000\,000\,007\,(= 10^9 + 7)</var> で割った余りを表す整数を 1 行に出力せよ．

h2. 採点基準

* 採点用データのうち，配点の 50% 分については <var>N \leqq 30</var> を満たす．
* 採点用データのうち，配点の 70% 分については <var>N \leqq 70</var> を満たす．

h2. 入出力の例

|_. 入力例1|_. 出力例1|
|<samp>5
4 3
3 1
6 5
2 1
4 2</samp>|<samp>4</samp>|

カンガルー 1 ，カンガルー 2 ，およびカンガルー 5 はカンガルー 3 のポケットに入ることができる．またカンガルー 4 はカンガルー 1 またはカンガルー 3 のポケットに入ることができ，カンガルー 3 は他のどのカンガルーのポケットにも入ることはできない．よって，最後の状態としてありうるのは以下の 4 通りである．
* カンガルー 4 がカンガルー 3 のポケットに入っている．
* カンガルー 4 はカンガルー 1 のポケットに入っており，カンガルー 1 はカンガルー 3 のポケットに入っている．
* カンガルー 4 はカンガルー 1 のポケットに入っており，カンガルー 2 はカンガルー 3 のポケットに入っている．
* カンガルー 4 はカンガルー 1 のポケットに入っており，カンガルー 5 はカンガルー 3 のポケットに入っている．

|_. 入力例2|_. 出力例2|
|<samp>20
7 6
7 3
10 1
7 2
10 7
10 7
8 6
3 2
5 4
7 2
3 2
10 9
9 4
7 2
8 6
5 4
8 6
7 4
10 5
9 3</samp>|<samp>21060</samp>|
