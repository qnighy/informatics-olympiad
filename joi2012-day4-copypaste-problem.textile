---
layout: default
title: "Copy and Paste(コピー＆ペースト) - joi2012-day4"
source: "第11回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2012/2012-sp-tasks/index.html"
timelimit: "17秒"
memlimit: "512MB"
---

テキストエディタの最も重要な機能の 1 つとして，コピー＆ペースト (複写・貼付) がある．JOI 社は，コピー＆ペーストを非常に高速に処理するテキストエディタの開発を開始した．JOI 社に所属する優秀なプログラマであるあなたは，核となるコピー＆ペーストの処理の実装の担当となった．JOI 社の命運が懸かっているので，何としても正確かつ高速なプログラムを作成したい．

具体的な仕様は次のとおりである．初め，ファイルの内容は文字列 <var>S</var> である．引き続いて，コピー＆ペーストの操作が <var>N</var> 回行われる．<var>i</var> 回目の操作は，位置 <var>A_i</var> から位置 <var>B_i</var> までの文字列を複写し，複写された文字列を元の文字列の位置 <var>C_i</var> に挿入貼付する，というものである．ここで，位置 <var>x</var> とは，文字列の先頭から <var>x</var> 個の文字をたどった直後の箇所を表す (位置 <var>0</var> は文字列の先頭である)．ただし，操作後に文字列の長さが <var>M</var> を超えた場合，長さが <var>M</var> になるまで文字列の右端から順に文字が削除される．<var>N</var> 回の操作後に得られる文字列を求めたい．

h2. 課題

文字列の長さの上限 <var>M</var>，初めの文字列 <var>S</var>，操作の回数 <var>N</var> および <var>N</var> 回のコピー＆ペーストの操作の指示が与えられたとき，操作後の文字列を出力するプログラムを作成せよ．

h2. 制限

| <var>1 \leqq M \leqq 1\,000\,000</var> | 文字列の長さの上限 |
| <var>1 \leqq N \leqq 1\,000\,000</var> | 操作の回数 |

h2. 入力

標準入力から以下の入力を読み込め．

* <var>1</var> 行目には整数 <var>M</var> が書かれており，文字列の長さの上限を表す．
* <var>2</var> 行目には文字列 <var>S</var> が書かれており，初めの文字列を表す．<var>S</var> はアルファベットの小文字からなり，長さは <var>1</var> 以上 <var>M</var> 以下である．
* <var>3</var> 行目には整数 <var>N</var> が書かれており，操作の回数を表す．
* <var>3 + i</var> 行目 (<var>1 \leqq i \leqq N</var>) には整数 <var>A_i, B_i, C_i</var> が空白を区切りとして書かれており，<var>i</var> 回目の操作は位置 <var>A_i</var> から位置 <var>B_i</var>までの文字列を複写し位置 <var>C_i</var> に挿入貼付する，というものであることを表す．<var>i</var>回目の操作の直前の文字列の長さを <var>L_i</var> とすると，<var>0 \leqq A_i &lt; B_i \leqq L_i</var> および <var>0 \leqq C_i \leqq L_i</var> を満たす．

h2. 出力

標準出力に，<var>N</var> 回の操作後の文字列を <var>1</var> 行で出力せよ．

h2. 採点基準

* 採点用データのうち，配点の 10% 分については，<var>M \leqq 100\,000</var>，<var>N \leqq 100\,000</var> を満たす．

h2. 入出力例

|_. 入力例1|_. 出力例1|
|<samp>18
copypaste
4
3 6 8
1 5 2
4 12 1
17 18 0</samp>|<samp>acyppypastoopyppyp</samp>|

この例では，<var>N = 4</var> 回のコピー＆ペーストの操作は以下のように行われる．
* 初めの文字列は copypaste である．
* <var>1</var> 回目の操作では，位置 <var>3</var> から位置 <var>6</var> までの文字列 ypa が複写され，位置 <var>8</var> に挿入貼付されることで，文字列 copypastypae を得る．
* <var>2</var> 回目の操作では，位置 <var>1</var> から位置 <var>5</var> までの文字列 opyp が複写され，位置 <var>2</var> に挿入貼付されることで，文字列 coopyppypastypae を得る．
* <var>3</var> 回目の操作では，位置 <var>4</var> から位置 <var>12</var> までの文字列 yppypast が複写され，位置 <var>1</var> に挿入貼付されることで，文字列 cyppypastoopyppypastypae を得るが，長さが <var>M = 18</var> を超えているため，右端から文字が削除され，文字列 cyppypastoopyppypa を得る．
* <var>4</var> 回目の操作では，位置 <var>17</var> から位置 <var>18</var> までの文字列 a が複写され，位置 <var>0</var> に挿入貼付されることで，文字列 acyppypastoopyppypa を得るが，長さが <var>M = 18</var> を超えているため，右端から文字が削除され，文字列 acyppypastoopyppyp を得る．

|_. 入力例2|_. 出力例2|
|<samp>100
joi
3
0 1 0
3 4 3
2 3 3</samp>|<samp>jjooii</samp>|
