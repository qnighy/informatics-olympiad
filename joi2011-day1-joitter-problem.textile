---
layout: default
title: "joitter(ジョイッター) - joi2011-day1"
source: "第10回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2011/2011-sp-tasks/index.html"
timelimit: "1秒"
memlimit: "64MB"
---

ジョイッター (Joitter) は，短い日記の気軽な投稿や写真の共有を通して，知り合いとのインターネット上でのコミュニケーションをより快適にする，話題沸騰中のソーシャル・ネットワーキング・サービス (SNS) である．

ジョイッターでは，自分以外のユーザを「友人」というリストに登録することができる．あるユーザ A があるユーザ B を「友人」として登録しようとすると，ユーザ B に通知が届く．ユーザ B がこれに許可することで，<var>2</var> 人は互いに「友人」として登録される．これを <var>1</var> 回の「友人」登録と考える．「友人」登録には，なぜか <var>2</var> 人のユーザに依存したコストがかかる．ユーザ A とユーザ B が互いに「友人」でありユーザ B とユーザ C が互いに「友人」であっても，ユーザ A とユーザ C が互いに「友人」となるとは限らない．

ジョイッターでは，ユーザは日記の公開設定を以下の <var>3</var> 種類のいずれかに設定できる．

* (1) 「友人」にのみ公開する．
* (2) 「友人」あるいは「友人」の「友人」であるユーザにのみ公開する．
* (3) 「友人」関係を辿って到達できるユーザにのみ公開する．

<var>N</var> 人が新しくジョイッターに登録した．日記の公開設定として各々が上記の (1), (2), (3) のいずれかを選んだ．偶然にも，<var>N</var> 人の中でちょうど <var>1</var> 人だけが選んだ公開設定は存在しなかった．

現在，<var>N</var> 人の間の「友人」関係は全く登録されていない．<var>N</var> 人全員が他の全員の日記を読めるようになるには，最小で何回の「友人」登録が必要であろうか．また，最小回数の「友人」登録でこれを達成するための最小のコストはいくらになるだろうか．

h2. 課題


<var>N</var> 人の日記の公開設定と，各 <var>2</var> 人の組が「友人」として登録されるためのコストが与えられたとき，<var>N</var> 人全員が他の全員の日記を読めるようになるための「友人」登録の回数の最小値と，その回数を実現する最小のコストを求めるプログラムを作成せよ．

h2. 制限

| <var>2 \leq N \leq 1\,000</var> | ユーザの人数 |
| <var>1 \leq C_{i j} \leq 1\,000 (i \neq j)</var> | 「友人」登録のためのコスト |

h2. 入力

標準入力から以下の入力を読み込め．

* <var>1</var> 行目には整数 <var>N</var> が書かれており，ユーザの人数を表す．ユーザには <var>1</var> から <var>N</var> までの番号がつけられている．
* 続く <var>N</var> 行には各ユーザの日記の公開設定が書かれている．<var>1 + i</var> 行目 <var>(1 \leq i \leq N)</var> には，ユーザ <var>i</var> の日記の公開設定を表す <var>1</var> つの整数が書かれている．この整数は <var>1, 2, 3</var> のいずれかであり，公開設定 (1), (2), (3) のそれぞれに対応する．どのユーザに対しても，他の誰かとは同じ公開設定になっていることが保証されている．
* 続く <var>N</var> 行には「友人」登録のためのコストが書かれている．<var>1 + N + i</var> 行目 <var>(1 \leq i \leq N)</var> には <var>N</var> 個の整数が空白を区切りとして書かれており，そのうちの <var>j</var> 番目 <var>(1 \leq j \leq N)</var> の整数 <var>C_{i j}</var> は，ユーザ <var>i</var> とユーザ <var>j</var> が友人として登録されるためのコストを表す．任意の <var>i, j</var> に対して <var>C_{i i} = 0</var> および <var>C_{i j} = C_{j i}</var> を満たす．

h2. 出力

標準出力に，<var>N</var> 人全員が全員の日記を読めるようになるための「友人」登録の回数の最小値と，その回数を実現する最小のコストを表す <var>2</var> つの整数を，空白を区切りとして <var>1</var> 行に出力せよ．

h2. 入出力の例

|_. 入力例1|_. 出力例1|
|<samp>7
1
3
2
1
3
1
2
0 5 2 1 6 3 2
5 0 1 5 2 4 8
2 1 0 3 4 1 1
1 5 3 0 4 9 5
6 2 4 4 0 6 2
3 4 1 9 6 0 6
2 8 1 5 2 6 0</samp>|<samp>15 62</samp>|

|_. 入力例2|_. 出力例2|
|<samp>5
2
2
3
2
3
0 2 1 9 9
2 0 8 4 6
1 8 0 7 5
9 4 7 0 8
9 6 5 8 0</samp>|<samp>4 20</samp>|

|_. 入力例3|_. 出力例3|
|<samp>3
3
3
3
0 8 7
8 0 9
7 9 0</samp>|<samp>2 15</samp>|

