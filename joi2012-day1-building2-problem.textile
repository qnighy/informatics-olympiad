---
layout: default
title: "Building 2(ビルの飾り付け 2) - joi2012-day1"
source: "第11回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2012/2012-sp-tasks/index.html"
timelimit: "1秒"
memlimit: "64MB"
---

日本には <var>N</var> 個の街があり，それらの間は <var>N - 1</var> 本の双方向に通行可能な道路で結ばれている．どの街からどの街へもいくつかの道路をたどって行くことができる．各街には役所のビル 1 つがあり，街 <var>i</var> のビルの高さを <var>H_i</var> とする．

国際情報オリンピックが日本で開かれるに伴い，世界の選手達を歓迎するため，観光ツアーを計画しようとしている．観光ツアーは，ある街からスタートし，道路をたどって違う街へ移動することを繰り返し，ある街で終了する．この時，同じ街を <var>2</var> 度以上訪れることはないようにすることとなっている．

世界の選手たちをより一層歓迎するため，観光で訪れるうちの一部の街の役所のビルを飾り付けることにした．ある著名なデザイナーにデザインを依頼したところ，飾りつけに利用するビルは，出発する街から到着する街に向けて高くなっていく必要があると言った．つまり，役所のビルを飾り付けることにした街を <var>i_1, i_2, …, i_k</var> とおき，観光ツアー中にこれらの街を <var>i_1, i_2, …, i_k</var> という順番で訪れるとしたとき，ビルの高さが <var>H_{i_1} &lt; H_{i_2} &lt; … &lt; H_{i_k}</var> となっていなければならない．（全ての訪れる街のビルを飾り付けなければならないわけではないことに注意せよ．）

h2. 課題

できるだけ飾りつけを華やかにするため，飾りつけに利用するビルの数をできるだけ多くしたい．開始する街，終了する街，ビルの飾り付けをする街を自由に選べるとしたとき，飾りつけに利用することのできるビルの数の最大値を計算するプログラムを作れ.

h2. 制限

| <var>2 \leqq N \leqq 100\,000</var> | 街の数 |
| <var>1 \leqq H_i \leqq 1\,000\,000\,000</var> | 街 <var>i</var> のビルの高さ |


h2. 入力

標準入力から以下の入力を読み込め．

<var>1</var> 行目には整数 <var>N</var> が書かれており，街の数を表す．

* 続く <var>N</var> 行には，各街の役所のビルの高さに関する情報が与えられる．これらの行のうちの <var>i</var> 行目には整数 <var>H_i</var> が書かれている．これは街 <var>i</var> のビルの高さが <var>H_i</var> であることを表す．

* 続く <var>N-1</var> 行には，道路に関する情報が与えられる．これらの行のうちの <var>i</var> 行目には整数 <var>A_i, B_i</var> (<var>1 \leqq A_i &lt; B_i \leqq N</var>) が空白を区切りとして書かれている．これは <var>i</var> 番目の道路が街 <var>A_i</var> と街 <var>B_i</var> を結んでいることを表す．

h2. 出力

標準出力に，飾りつけに利用することのできるビルの数の最大値を表す整数を出力せよ．

h2. 採点基準

* 採点用データのうち，配点の <var>10%</var> 分については <var>N \leqq 100</var> を満たす．
* 採点用データのうち，配点の <var>30%</var> 分については <var>N \leqq 2\,000</var> を満たす．

h2. 入出力例

|_. 入力例|_. 出力例|
|<samp>7
4
2
5
3
1
8
7
1 2
2 3
3 4
4 5
3 6
6 7</samp>|<samp>4</samp>|
