---
layout: default
title: "Constellation(星座) - joi2012-day2"
source: "第11回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2012/2012-sp-tasks/index.html"
timelimit: "1秒"
memlimit: "64MB"
---

JOI 君は星空の観察が大好きな少年である．毎晩のように星空を観察しては，それぞれの星がどの星座に属するのかを調べて楽しんでいる．

ある晩，JOI 君がいつものように星空を観察していると，見たことのない星を <var>N</var> 個発見した．これらの星がどの星座に属するのかが気になった JOI 君は，夜空を写真に撮り，翌日図書館でこれらの星について調べてみた．すると，これらの星はすべて星座 A か星座 B のどちらかに属することと，これらの星のうちいくつかの星がどちらに属しているかがわかった．だが，その他の星については，どちらの星座に属しているかがわからなかった．JOI 君は，星座 A と星座 B を構成する星の集合として考えられるものが何通りあるかが気になった．なお，星の大きさは十分小さいので，点とみなしてよい．

ただし，星座とは，写真上で <var>1</var> つ以上の星と，星 <var>2</var> つを結ぶ線分いくつかからなり，以下の条件を満たす．星 <var>1</var> つのみからなるものも星座とみなすことに注意せよ．
* ある星座を構成する任意の <var>2</var> つの星は，写真上でその星座を構成する線分を辿ることで互いに到達することができる．
* ある星座を構成する線分と別の星座を構成する線分は交わらない．

また，JOI 君の発見した星は，以下の条件を満たす．
* どの <var>3</var> つの星も，写真上で同一直線上にない．
* どの星も星座 A または星座 B に属し，JOI 君の発見した星以外で星座 A または星座 B に属するものは存在しない．

h2. 課題

<var>N</var> 個の星の情報が与えられたとき，星座 A と星座 B を構成する星の集合として考えられるものの総数を <var>1\,000\,000\,007\,(=10^9+7)</var> で割った余りを求めるプログラムを作成せよ．

h2. 制限

| <var>2 \leqq N \leqq 100\,000</var> | JOI 君の発見した星の数 |
| <var>0 \leqq X_i \leqq 10^9, 0 \leqq Y_i \leqq 10^9</var> | 星 <var>i</var> の写真上での座標 |

h2. 入力

標準入力から以下の入力を読み込め．
* <var>1</var> 行目には整数 <var>N</var> が書かれており，JOI 君の発見した星の数を表す．
* 続く <var>N</var> 行には，星の情報が書かれている．<var>i+1</var> 行目 <var>(1 \leqq i \leqq N)</var> には，<var>3</var> つの整数 <var>X_i, Y_i, C_i</var> が空白区切りで書かれている．<var>X_i, Y_i</var> は星 <var>i</var> の写真上での座標が <var>(X_i, Y_i)</var> であることを表す．<var>C_i</var> は星 <var>i</var> が星座 A と星座 B のどちらに属しているかを表す．
** <var>C_i=0</var> の場合は星 <var>i</var> がどちらの星座に属するかわからないことを表す．
** <var>C_i=1</var> の場合は星 <var>i</var> が星座 A に属していることを表す．
** <var>C_i=2</var> の場合は星 <var>i</var> が星座 B に属していることを表す．

h2. 出力

星座 A と星座 B を構成する星の集合として考えられるものの総数を <var>1\,000\,000\,007\,(=10^9+7)</var> で割った余りを <var>1</var> 行で出力せよ．そのような星の集合が存在しない場合，<var>0</var> を出力せよ．

h2. 採点基準

* 採点用データのうち，配点の 10% 分については <var>N \leqq 10</var> を満たす．
* 採点用データのうち，配点の 50% 分については <var>N \leqq 300</var> を満たす．

h2. 入出力例

|_. 入力例1|_. 出力例1|
|<samp>4
1 1 1
2 1 1
1 2 0
2 2 2</samp>|<samp>2</samp>|

この入力例は，次の図に対応している．ただし，黒い点は星座 A に属する星を，白い点は星座 B に属する星を，×印はどちらの星座に属するかわからない星を，それぞれ表す．

<div class="img-tableau">
  <img src="joi2012-day2-constellation-img1.png" width="410" height="414" alt="[Constellation img1]"><br>
</div>

この入力に対する答えは，星 <var>3</var> が星座 A に属する場合と星座 B に属する場合の <var>2</var> 通りであり，それぞれの場合の星座の図の一例を以下に示す．星 <var>3</var> が星座 A に属する場合，星座 A の線分の引き方は何通りか考えられるが，それらすべてをまとめて <var>1</var> 通りと数えることに注意せよ．

<div class="img-tableau">
  <img src="joi2012-day2-constellation-img2.png" width="804" height="425" alt="[Constellation img2]"><br>
</div>
