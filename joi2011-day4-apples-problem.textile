---
layout: default
title: "Apples(リンゴの出荷) - joi2011-day4"
source: "第10回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2011/2011-sp-tasks/index.html"
timelimit: "4秒"
memlimit: "256MB"
---

JOI 農場ではリンゴの入荷と出荷を行っている．JOI 農場は <var>1</var> つずつリンゴを入荷し，出荷依頼が来た場合は次の入荷を待たずに対応を行う．出荷依頼では出荷するリンゴの個数が指定されており，JOI 農場は出荷依頼が来た時，出荷依頼で指定されている個数のリンゴを，JOI 農場の決まりを満たす組み合わせで出荷できる場合，すぐにそれらのリンゴを出荷する．一方，出荷できない場合は，出荷できないことを伝えリンゴは全く出荷しない．

今年は JOI 農場に多くのリンゴの入荷と多くの出荷依頼が来ることが見込まれている．そこで，あなたに JOI 農場のためのリンゴ管理プログラムを書いて欲しい．

h2. 課題

各々のリンゴには色の濃さが整数値で決まっている．<var>1</var> 回の出荷におけるリンゴの濃さのバラつきとは，出荷されるリンゴの濃さの最大値と最小値の差である．JOI 農場では各出荷依頼について，濃さのバラつきが <var>B</var> 以下でなければならない，という決まりがある．

JOI 農場が行うリンゴ管理プログラムへは合計 <var>M</var> 個の要求が行われる．<var>i</var> 番目の要求は「リンゴの入荷」「出荷依頼」「プログラムの終了」の <var>3</var> 種類のうちのいずれかである．それぞれの要求に対し，リンゴ管理プログラムは以下の動作をしなければならない．

* 「リンゴの入荷」の要求に対しては，濃さの値が <var>D_i</var> のリンゴを <var>1</var> 個入荷したことが入力されるので，これを記憶する．
* 「出荷依頼」の要求に対しては，<var>N_i</var> 個のリンゴを出荷する出荷依頼が来たことが入力されるので，出荷できる場合は出荷するリンゴの濃さの値をそれぞれ昇順に出力し，出荷できない場合は NO を出力する．ただし，出荷するリンゴの組み合わせの候補が複数存在する場合は，リンゴの色の濃さの値の総和が最も大きくなる組み合わせを選択する．
* 「プログラムの終了」の要求に対しては，リンゴ管理プログラムの終了命令が入力されるので，プログラムを終了する．

h2. 注意

この課題は応答型課題 (Reactive task) である．<var>i</var> 番目の要求が「出荷依頼」である場合，<var>i + 1</var> 番目の要求の入力は <var>i</var> 番目の出荷依頼に対する出力をした後に与えられる．

また，出力がバッファされ，読み込みが誤ってブロックされてしまうことを防ぐ必要がある．そのため読み込みを行う前に fflush(stdout); などを記述しておくことを勧める．

h2. 制限

| <var>1 \leq M \leq 100\,000</var> | プログラムに渡される要求の数 |
| <var>0 \leq B \leq 1\,000\,000\,000</var> | 各出荷毎のリンゴの濃さのバラつきの上限値 |
| <var>0 \leq D_i \leq 1\,000\,000\,000 (1 \leq i \leq M)</var> | <var>i</var> 番目の要求で入荷するリンゴの色の濃さの値 |
| <var>1 \leq N_i \leq 100\,000 (1 \leq i \leq M)</var> | <var>i</var> 番目の要求で出荷するリンゴの個数 |

h2. 入力

標準入力から以下の入力を読み込め．

* <var>1</var> 行目には整数 <var>M, B</var> が空白を区切りとして書かれており，要求の個数が <var>M</var> 個，JOI 農場の決まりである，リンゴの濃さのバラつきの上限値が <var>B</var> であることを表す．
* <var>1 + i</var> 行目 <var>(1 \leq i \leq M  1)</var> には「リンゴの入荷」「出荷依頼」のどちらかの要求を示す情報が書かれている．
** <var>i</var> 番目の要求が「リンゴの入荷」である場合，文字 A と，入荷したリンゴの色の濃さの値を表す整数 <var>D_i</var> が空白を区切りとして書かれている．
** <var>i</var> 番目の要求が「出荷依頼」である場合，文字 R と，出荷依頼の依頼内容である出荷するリンゴの個数を表す整数 <var>N_i</var> が空白を区切りとして書かれている．
* <var>1 + M</var> 行目には「プログラムの終了」の要求を表す文字 E のみが書かれている．

h2. 出力

各「出荷依頼」の要求を受けた時に，出荷できない場合は文字列 NO を <var>1</var> 行で出力せよ．出荷できる場合は，出荷するリンゴの色の濃さを昇順で空白を区切りとして <var>1</var> 行に出力せよ．

h2. 採点基準

* 採点用データのうち，配点の <var>30%</var> 分については，<var>B \leq 10\,000</var> かつ <var>D_i \leq 10\,000 (1 \leq i \leq M)</var> を満たす．

h2. 入出力の例

|_. 入力例|_. 出力例|
|<samp>22 10
A 5
A 16
R 2</samp>||
||<samp>NO</samp>|
|<samp>A 10
R 2</samp>||
||<samp>10 16</samp>|
|<samp>R 2</samp>||
||<samp>NO</samp>|
|<samp>A 15
A 5
R 2</samp>||
||<samp>5 15</samp>|
|<samp>A 5
R 2</samp>||
||<samp>5 5</samp>|
|<samp>A 0
A 10
R 1</samp>||
||<samp>10</samp>|
|<samp>A 10
A 10
R 4</samp>||
||<samp>NO</samp>|
|<samp>A 30
R 4</samp>||
||<samp>NO</samp>|
|<samp>A 0
R 4</samp>||
||<samp>0 0 10 10</samp>|
|<samp>E</samp>||