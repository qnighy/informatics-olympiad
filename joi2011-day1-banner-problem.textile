---
layout: default
title: "Banner(横断幕) - joi2011-day1"
source: "第10回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2011/2011-sp-tasks/index.html"
timelimit: "1.5秒"
memlimit: "64MB"
---

20XX 年，ついに IOI が JOI 国で開催されることになった． JOI 国ではこれを祝い，街中に歓迎の横断幕 (banner) をかけることにした．JOI 国では，図のように，東西方向に走る <var>H</var> 本の道路と，南北方向に走る <var>W</var> 本の道路が碁盤目状に通っている．東西方向に走る道路と南北方向に走る道路が交わるところを交差点と呼ぶ．北から <var>a</var> 番目，西から <var>b</var> 番目の交差点を <var>(a，b)</var> で表す．

各交差点にはそれぞれ柱が <var>1</var> 本ずつ立っている．JOI 国には国を象徴する色が黒色・灰色・白色の <var>3</var> 色あり，各柱はこの <var>3</var> 色のうちのどれか <var>1</var> 色で塗られている．

<div class="img-tableau">
  <img src="joi2011-day1-banner-img1.png" width="245" height="159" alt="[Banner img1]"><br>
  図: JOI 国の図( <var>H = 3, W = 4</var> の場合)．図の上が北，左が西に対応する．
</div>

横断幕はこれらの柱を支柱としてかけることができる．ただし，横断幕が道路でないところを通っていると邪魔になってしまう．そこで，交差点に立っているこれらの柱のうち，「各辺がいずれかの道路と平行であるような長方形」の <var>4</var> 頂点となっているような異なる <var>4</var> 本の柱を選び，その周囲に横断幕をかける．さらに，このとき選ぶ <var>4</var> 本の柱に黒色の柱・灰色の柱・白色の柱がそれぞれ <var>1</var> つ以上含まれているようにしたい．

このような <var>4</var> 本の柱の選び方は何通りあるだろうか．

h2. 課題

<var>H，W</var> と，JOI 国に立っている柱の色の情報が与えられたとき，<var>4</var> 本の柱の選び方の数を出力するプログラムを作成せよ．

h2. 制限

| <var> 2 \leq H \leq 400</var> | 東西に走る道路の本数 |
| <var> 2 \leq W \leq 400</var> | 南北に走る道路の本数 |

h2. 入力

標準入力から以下の入力を読み込め．

* 1 行目には整数 <var>H, W</var> が空白を区切りとして書かれている．
* 続く <var>H</var> 行には，JOI 国の交差点に立っている柱の色の情報が書かれている．<var>i + 1</var> 行目 <var>(1 \leq i \leq H)</var> には，<var>0, 1, 2</var> いずれかの整数が <var>W</var> 個空白区切りで書かれている．<var>i + 1</var> 行目の <var>j</var> 番目に書かれている整数が <var>0</var> なら，交差点 <var>(i, j)</var> に立っている柱が黒色であることを表し，同様に，書かれている整数が <var>1</var> なら灰色，<var>2</var> なら白色であることを表す．


h2. 出力

標準出力に，<var>4</var> 本の柱の選び方の数を <var>1</var> 行で出力せよ．

h2. 採点基準

採点用データのうち，配点の <var>40%</var> 分については，<var>H \leq 100</var> かつ <var>W \leq 100</var> を満たす．

h2. 入出力の例

|_. 入力例|_. 出力例|
|<samp>3 4
0 1 0 2
1 2 0 1
0 0 2 1</samp>|<samp>12</samp>|

この入力例では，<var>4</var> 本の柱の選び方として

* (1，1)，(2，1)，(2，2)，(1，2)
* (1，1)，(2，1)，(2，4)，(1，4)
* (1，2)，(2，2)，(2，3)，(1，3)
* (1，3)，(2，3)，(2，4)，(1，4)
* (1，1)，(3，1)，(3，4)，(1，4)
* (1，2)，(3，2)，(3，3)，(1，3)
* (1，2)，(3，2)，(3，4)，(1，4)
* (1，3)，(3，3)，(3，4)，(1，4)
* (2，1)，(3，1)，(3，2)，(2，2)
* (2，1)，(3，1)，(3，3)，(2，3)
* (2，2)，(3，2)，(3，4)，(2，4)
* (2，3)，(3，3)，(3，4)，(2，4)

の <var>12</var> 通りが存在するので <var>12</var> を出力する．
