---
layout: default
title: "Orienteering(オリエンテーリング) - joi2011-day4"
source: "第10回日本情報オリンピック 日本代表選手選考会"
source_url: "http://www.ioi-jp.org/camp/2011/2011-sp-tasks/index.html"
timelimit: "1秒"
memlimit: "64MB"
---

あなたの通う JOI 高校では，年に一度，オリエンテーリングが行われ，全校生徒が参加する．オリエンテーリングとは，地図と方位磁針を用い，山野に設置されたチェックポイントを巡る競技である．

JOI 高校のオリエンテーリングは，<var>2</var> 人一組のチームで参加するという特徴がある．各チームの <var>2</var> 人は，指定されたスタート地点から一緒にスタートするが，その後は別々に行動をし，指定されたゴール地点を目指す．<var>2</var> 人がゴール地点に到達した際，それぞれのチェックポイントをチームのうちの少なくとも <var>1</var> 人が訪れていないとならない．<var>2</var> 人は途中で同じ地点を訪れても構わない．また，<var>2</var> 人が途中で同じ道を通っても構わない．

JOI 高校のオリエンテーリングが行われる JOI 山には，<var>N</var> 個の地点があり，それらの間を <var>M</var> 本の道が繋いでいる．<var>N</var> 個の地点には <var>1</var> から <var>N</var> までの番号が付いている．スタートはふもとにある地点 <var>1</var> であり，ゴールは頂上の地点 <var>N</var> である．スタートとゴール以外の地点のうち一部または全部がチェックポイントとして指定される．

JOI 高校は，混乱を避けるため，オリエンテーリングの間，それぞれの道を，高度が低い方の地点から高度が高い方の地点への一方通行とする．高度が等しい <var>2</var> つの地点は存在しない．スタートである地点 <var>1</var> は最も高度の低い地点であり，ゴールである地点 <var>N</var> は最も高度の高い地点であるが，地点の番号は必ずしも高度の低い地点から順につけられているわけではないことに注意せよ．JOI 山では，このように道を一方通行にしても，地点 <var>1</var> から全ての地点に行くことができ，また，全ての地点から地点 <var>N</var> に行くことができる．

h2. 課題

条件を満たすような一組のチームの <var>2</var> 人の移動方法に関して，移動距離の合計の最小値を求めるプログラムを作成せよ．そのような <var>2</var> 人の移動方法が存在することは保証されている．

h2. 制限

| <var>3 \leq N \leq 1\,000</var> | 地点の個数 |
| <var>2 \leq M \leq 10\,000</var> | 道の本数 |
| <var>1 \leq K \leq N - 2</var> | チェックポイントの数 |
| <var>1 \leq C_j \leq 10\,000</var> | 道 <var>j</var> の長さ |

h2. 入力

標準入力から以下の入力を読み込め．

* <var>1</var> 行目には整数 <var>N, M</var> が空白を区切りとして書かれており，地点の数が <var>N</var> 個，道の数が <var>M</var> 本であることを表す．
* 続く <var>N</var> 行には各地点がチェックポイントであるかどうかの情報が書かれている．<var>1 + i</var> 行目 <var>(1 \leq i \leq N)</var> には，<var>0</var> か <var>1</var> の整数 <var>S_i</var> が書かれており，<var>S_i</var> が <var>0</var> の場合，地点 <var>i</var> はチェックポイントではなく，<var>S_i</var> が <var>1</var> の場合，地点 <var>i</var> はチェックポイントであることを表す．常に <var>S_1 = S_N = 0</var> である．
* 続く <var>M</var> 行には道の情報が書かれている．<var>1 + N + j</var> 行目 <var>(1 \leq j \leq M)</var> には，整数 <var>A_j, B_j, C j</var> が空白を区切りとして書かれており，道 <var>j</var> は地点 <var>A_j</var> から地点 <var>B_j</var> を結び，道 <var>j</var> の長さが <var>C_j</var> であることを表す．地点 <var>A_j</var> は地点 <var>B_j</var> より高度が低い地点であり，道 <var>j</var> は地点 <var>A_j</var> から地点 <var>B_j</var> への一方通行となるものとする．必ず <var>A_j , B_j</var> であり，また，<var>A_j = A_k</var> かつ <var>B_j = B_k</var> なる道 <var>k (k \neq j)</var> は存在しない．

h2. 出力

条件を満たすような一組のチームの <var>2</var> 人の移動方法に関する，移動距離の合計の最小値を出力せよ．

採点基準

以下，チェックポイントの数を <var>K</var> とおく．すなわち，<var>K = S 1 + S 2 + … + S N</var> である．

* 採点用データのうち，配点の <var>30%</var> 分については，<var>K \leq 10</var> を満たす．
* 採点用データのうち，配点の <var>30%</var> 分については，<var>N \leq 100</var> かつ <var>M \leq 500</var> を満たす．
* 採点用データのうち，配点の <var>10%</var> 分については，これら <var>2</var> つの条件の両方を満たす.
* 採点用データのうち，配点の <var>50%</var> 分については，これら <var>2</var> つの条件の少なくとも一方を満たす.

h2. 入出力の例

|_. 入力例|_. 出力例|
|<samp>8 12
0
1
0
0
1
1
0
0
1 4 5
1 6 5
4 2 4
4 7 9
4 5 6
2 5 8
2 8 3
6 2 7
6 7 8
7 3 2
3 5 7
5 8 3</samp>|<samp>29</samp>|

この入力例は，下図に対応する．チェックポイントとなっている地点は水色で示されている．また，最小の移動距離を達成する <var>2</var> 人の移動方法は赤色で示されている．

<div class="img-tableau">
  <img src="joi2011-day4-orienteering-img1.png" width="165" height="452" alt="[Orienteering img1]">
</div>

